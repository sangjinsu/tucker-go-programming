# 24장 고루틴

- 쓰레드는 실행 흐름을 의미한다
- 쓰레드 전환에는 비용이 발생한다
- 컨텍스트 스위칭
- 만약 쓰레드 개수 = 코어 개수가 되면?

### 고루틴

- 메인함수도 고루틴
- 고루틴은 OS 쓰레드를 이용하는 경량 스레드이다
- 시스템 콜 호출시 (파일 또는 네트워크 읽기/쓰기)
    - 호출한 고루틴은 네트워크 대기 상태로 이동하고
    - 대기 중인 고루틴이 OS 스레드를 점유한다
- OS 스레드가 교체되는 컨텍스트 스위치 비용이 발생하지 않지만 고루틴의 컨텍스트 스위칭 비용이 발생한다. 하지만 고루틴의 컨텍스트 스위칭 비용은 매우 적어서 경량 스레드라고 불린다

### 동시성 프로그래밍의 주의점

동일한 메모리 자원을 여러 스레드에서 접근할 때 동시성 문제가 발생한다

#### 해결책

1. 메모리 자원을 한 스레드에서만 접근하도록 한다 (Lock, Mutex)

- 뮤텍스의 문제점
    1. 동시성 프로그래밍으로 인한 성능 향상을 얻을 수 없다
    2. 과도한 락킹은 성능을 하락시킨다
    3. 데드락 문제가 발생한다

뮤텍스 사용은 주의해야 한다

#### 다른 자원 관리 기법

- 영역을 나누는 방법
- 역할을 나누는 방법